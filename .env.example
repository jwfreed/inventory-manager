DATABASE_URL=postgres://user:password@localhost:5432/inventory_manager
PORT=3000
JWT_SECRET=replace-with-strong-secret
ACCESS_TOKEN_TTL=15m
REFRESH_TOKEN_TTL_DAYS=30
JSON_BODY_LIMIT=1mb
LOG_HTTP_REQUESTS=false

# Database timeouts
DB_STATEMENT_TIMEOUT_MS=5000
DB_LOCK_TIMEOUT_MS=2000

# Inventory movement idempotency enforcement
ENFORCE_INVENTORY_MOVEMENT_EXTERNAL_REF=true
ENFORCE_CANONICAL_MOVEMENT_FIELDS=false
# If set, movement lines created after this ISO timestamp must include canonical fields
CANONICAL_MOVEMENT_REQUIRED_AFTER=

# Worker + queues (BullMQ)
QUEUE_REDIS_URL=
RUN_INPROCESS_JOBS=false
WORKER_REGISTER_JOBS=true
WORKER_CONCURRENCY_CRITICAL=2
WORKER_CONCURRENCY_HEAVY=1
WORKER_CONCURRENCY_OUTBOX=4
OUTBOX_POLL_INTERVAL_MS=5000
OUTBOX_BATCH_SIZE=25
OUTBOX_MAX_ATTEMPTS=8
OUTBOX_RETRY_BASE_MS=2000
OUTBOX_RETRY_MAX_MS=60000
OUTBOX_RETRY_JITTER_MS=1000
OUTBOX_RETENTION_DAYS=7
OUTBOX_RETENTION_CRON=0 3 * * *
OUTBOX_RETENTION_BATCH=1000
OUTBOX_RETENTION_MAX_BATCHES=10
JOB_RETRY_ATTEMPTS=3
JOB_RETRY_BACKOFF_MS=5000

# Event bridge
EVENTS_CHANNEL=inventory:events
EVENT_SOURCE_ID=

# Inventory health gate thresholds
INVENTORY_HEALTH_MAX_VARIANCE_PCT=1
INVENTORY_HEALTH_MAX_VALUE_VARIANCE=0
INVENTORY_HEALTH_MAX_CYCLE_VARIANCE_PCT=2
INVENTORY_HEALTH_FAIL_ON_NEGATIVE=true
INVENTORY_HEALTH_CRON=0 * * * *

# Integration resiliency defaults
INTEGRATION_TIMEOUT_MS=5000
INTEGRATION_RETRIES=2
INTEGRATION_RETRY_BASE_MS=200
INTEGRATION_RETRY_MAX_MS=2000
INTEGRATION_RETRY_JITTER_MS=100

# Import limits
IMPORT_MAX_BYTES=10485760
IMPORT_MAX_ROWS=50000

# Health check timeouts
HEALTH_READY_TIMEOUT_MS=2000
HEALTH_DB_TIMEOUT_MS=1500
HEALTH_REDIS_TIMEOUT_MS=1000
# REQUIRED_SCHEMA_VERSION=1771300000000

# OpenTelemetry
OTEL_ENABLED=false
OTEL_SERVICE_NAME=inventory-manager-api
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318/v1/traces
